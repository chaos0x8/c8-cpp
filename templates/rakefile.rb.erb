namespace 'c8-<%= name %>' do
  p = C8.project 'c8-<%= name %>' do
    templates.cpp_include_directory 'src/c8-<%= name %>/errors.hpp' => Dir['src/c8-<%= name %>/errors/*.hpp']

    flags << $flags
    flags << %w[-Isrc]

    link 'lib/libc8-common.a'

    library 'lib/lib<%= name %>.a' do
      sources << Dir['src/c8-<%= name %>/**/*.cpp']
    end

    executable 'bin/c8-<%= name %>-ut' do
      flags << %w[-Itest]
      link_flags << %w[-pthread -lgtest -lgmock]
      sources << Dir['test/c8-<%= name %>/**/*.cpp']
    end
  end

  desc 'Builds c8-<%= name %>'
  C8.multitask(default: ['lib/lib<%= name %>.a', 'generated:default'])

  desc 'Runs c8-<%= name %> tests'
  C8.multitask(test: ['c8-<%= name %>:c8-<%= name %>', 'generated:default']) do
    sh 'bin/c8-<%= name %>-ut'
  end
end
